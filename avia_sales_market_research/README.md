# Анализ спроса пассажиров авиакомпании на рейсы по разным направлениям, а также в города, где проходят крупные фестивали


## Данные

<details>
<summary><b>query_1.csv</b></summary>
<ul type="circle">

<li>
<p><b>model</b> - модель самолета</p>
</li>

<li>
<p><b>flights_amount</b> - количество рейсов для каждой модели самолетов в сентябре 2018 года</p>
</li>

</ul>
</details>

<details>
<summary><b>query_3.csv</b></summary>
<ul type="circle">

<li>
<p><b>city</b> - город</p>
</li>

<li>
<p><b>average_flights</b> - среднее количество рейсов, прибывающих в город, в день в сентябре 2018 года</p>
</li>

</ul>
</details>

<details>
<summary><b>query_last.csv</b></summary>
<ul type="circle">

<li>
<p><b>week_number</b> - номер недели</p>
</li>

<li>
<p><b>ticket_amount</b> - количество проданных билетов за неделю</p>
</li>

<li>
<p><b>festival_week</b> - есть ли на этой неделе фестиваль</p>
</li>

<li>
<p><b>festival_name</b> - название фестиваля</p>
</li>

</ul>
</details>

## Задача

 - ***Выбрать ТОП-10 городов*** по среднему количеству прибывающих рейсов в день в сентябре 2018 года.
 - ***Построить графики***:
   - Количество рейсов для каждой модели самолетов в сентябре 2018 года;
   - Cреднее количество рейсов, прибывающих в город, в день в сентябре 2018 года;
   - ТОП-10 городов по среднему количеству прибывающих рейсов в день в сентябре 2018 года.
 - ***Проверить гипотезу***: «Средний спрос на билеты во время фестивалей не отличается от среднего спроса на билеты в обычное время».

## Итоги проекта
 - В рамках проекта было проведено извлечение данных с помощью SQL и библиотеки PySpark.
 - В сентябре 2018 года пассажиры предпочитали в основном летать в Москву (23% рейсов), Санкт-Петербург (6%), Новосибирск (3%). **Почти четверть всех рейсов авиакомпании в стране совершалась в Москву**.
 - Из ТОП-10 городов самыми популярными были Москва (52%), Санкт-Петербург (12%) и Новосибирск (7%). **Москва в рейтинге ТОП-10 занимает первое место с более чем половиной всех рейсов из рейтинга**.
 - Полеты в основном совершались на таких моделях самолетов, как: Cessna 208 Caravan, Bombardier CRJ-200, Sukhoi SuperJet-100.

![](img/plots.png)

- Для проверки гипотезы выбрали *t-критерий Стьюдента для независимых выборок*.
- **Не смогли отклонить нулевую гипотезу: средний спрос на билеты во время фестивалей не отличается от среднего спроса на билеты в обычное время**
- **Так как объемы наших выборок очень маленькие, к полученным результатам следует относиться осторожно**

## Библиотеки

 - *pyspark*
 - *pandas*
 - *matplotlib*
 - *numpy*
 - *scipy*
 - *statsmodels* 